par(mfrow = c(1, 2))
plot(emp_pdf)
plot(1*(t - 0.5)^2 + 11/12, type = "l")
U
coef_inv <- purrr::map(U, ~c(-.x, a/4 + b, -a/2, a/3))
coef_inv
U
coef_inv <- purrr::map(U, ~c(-.x, a/4 + b, -a/2, a/3))
roots_inv <- purrr::map(coef_inv, ~polyroot(.x))
id_real <- purrr::map(roots_inv, ~which(abs(Im(.x)) < 1e-7))
id_real
cdf_inv <- purrr::map2_dbl(roots_inv, id_real, ~Re(.x[.y]))
cdf_inv
roots_inv
id_real <- purrr::map(roots_inv, ~which(abs(Im(.x)) < 1e-7))
cdf_inv <- purrr::map2_dbl(roots_inv, id_real, ~Re(.x[.y]))
cdf_inv
min(cdf_inv)
max(cdf_inv)
boat_cdf <- function(a, nx, n) {
if(a < 0 & a >= 12) {
stop("a is out of range!")
}
b <- 1 - (a / 12)
x <- seq(0, 1, length.out = nx)
cdf <- a/3 * (x - 1/2)^3 + b*x + a/24
U <- runif(n)
coef_inv <- purrr::map(U, ~c(-.x, a/4 + b, -a/2, a/3))
roots_inv <- purrr::map(coef_inv, ~polyroot(.x))
id_real <- purrr::map(roots_inv, ~which(abs(Im(.x)) < 1e-7))
cdf_inv <- purrr::map2_dbl(roots_inv, id_real, ~Re(.x[.y]))
cdf_inv
# idx_ui <- sapply(U, function(ui) which.min(abs(ui - x)))
#
# cdf_inv[idx_ui]
}
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = density(test)
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(1*(t - 0.5)^2 + 11/12, type = "l")
a
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test)
t = seq(0, 1, l = length(test))
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(1*(t - 0.5)^2 + 11/12, type = "l")
?hist
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, freq = TRUE)
t = seq(0, 1, l = length(test))
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(1*(t - 0.5)^2 + 11/12, type = "l")
?ecdf
#check
test = boat_cdf(a = 1, nx = 10001, n = 100)
emp_pdf = hist(test, freq = TRUE)
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, freq = TRUE)
?density_estimate
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, freq = TRUE)
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(1*(t - 0.5)^2 + 11/12, type = "l")
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(seq(0, 1, l = length(t)), 1*(t - 0.5)^2 + 11/12, type = "l")
?hist
?density
?hist
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, freq = TRUE, probability = TRUE)
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, freq = TRUE, density = TRUE)
t = seq(0, 1, l = length(test))
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(seq(0, 1, l = length(t)), 1*(t - 0.5)^2 + 11/12, type = "l")
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, density = TRUE)
t = seq(0, 1, l = length(test))
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(seq(0, 1, l = length(t)), 1*(t - 0.5)^2 + 11/12, type = "l")
?hist
emp_pdf = hist(test, prob = TRUE)
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, prob = TRUE)
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, prob = TRUE)
t = seq(0, 1, l = length(test))
par(mfrow = c(1, 2))
plot(emp_pdf)
plot(seq(0, 1, l = length(t)), 1*(t - 0.5)^2 + 11/12, type = "l")
par(mfrow = c(1, 2))
lines(density(emp_df))
lines(density(emp_pdf))
emp_pdf
emp_pdf$density
?hist
1000^(-1/3)
#check
test = boat_cdf(a = 1, nx = 10001, n = 1000)
emp_pdf = hist(test, prob = TRUE, breaks = seq(0, 1, by = 1/25))
lines(emp_pdf$density)
plot(seq(0, 1, by = 1/25), emp_pdf$density, type = "l")
length(emp_pdf$density)
plot(seq(0, 1, length.out = 25), emp_pdf$density, type = "l")
#check
test = boat_cdf(a = 1, nx = 10001, n = 10000)
emp_pdf = hist(test, prob = TRUE, breaks = seq(0, 1, by = 1/25))
t = seq(0, 1, l = length(test))
plot(seq(0, 1, l = length(t)), 1*(t - 0.5)^2 + 11/12, type = "l")
#check
test = boat_cdf(a = 1, nx = 10001, n = 30000)
emp_pdf = hist(test, prob = TRUE, breaks = seq(0, 1, by = 1/25))
plot(seq(0, 1, l = length(t)), 1*(t - 0.5)^2 + 11/12, type = "l")
id_real <- purrr::map(roots_inv, ~which((abs(Im(.x)) < 1e-7) & (.x >= 0) &
(.x < 1)))
id_real <- purrr::map(roots_inv,
~which((abs(Im(.x)) < 1e-7) & (.x >= 0) &(.x < 1)))
id_real <- purrr::map(roots_inv,
~which((abs(Im(.x)) < 1e-7) & (Re(.x) >= 0) &(Re(.x) < 1)))
id_real
cdf_inv <- purrr::map2_dbl(roots_inv, id_real, ~Re(.x[.y]))
cdf_inv
boat_cdf <- function(a, n) {
if(a < 0 & a >= 12) {
stop("a is out of range!")
}
b <- 1 - (a / 12)
U <- runif(n)
coef_inv <- purrr::map(U, ~c(-.x, a/4 + b, -a/2, a/3))
roots_inv <- purrr::map(coef_inv, ~polyroot(.x))
id_real <- purrr::map(roots_inv,
~which((abs(Im(.x)) < 1e-7) & (Re(.x) >= 0) &(Re(.x) < 1)))
cdf_inv <- purrr::map2_dbl(roots_inv, id_real, ~Re(.x[.y]))
cdf_inv
}
rm(cdf_inv)
boat_cdf <- function(a, n) {
if(a < 0 & a >= 12) {
stop("a is out of range!")
}
b <- 1 - (a / 12)
U <- runif(n)
coef_inv <- purrr::map(U, ~c(-.x, a/4 + b, -a/2, a/3))
roots_inv <- purrr::map(coef_inv, ~polyroot(.x))
id_real <- purrr::map(roots_inv,
~which((abs(Im(.x)) < 1e-7) & (Re(.x) >= 0) &(Re(.x) < 1)))
purrr::map2_dbl(roots_inv, id_real, ~Re(.x[.y]))
}
test = boat_cdf(a = 1, n = 500)
plot(hist(test))
boat_cdf(a = 1, n = 500)
weights_loo
args(boat_cdf)
boat_cdf
y = boat_cdf(a = 1, n = 25)
y
a <- 1
n <- 100
m <- 25
points_list <- purrr::map(seq_len(n), function(x) boat_cdf(a = 1, m = 25))
boat_cdf
points_list <- purrr::map(seq_len(n), function(x) boat_cdf(a = 1, n = 25))
wm_sq_limit <- function(points_list, phi = function(x) 1, cdf = identity) {
#points_list <- purrr::map(seq_len(n), ~runif(m))
weights_list <- purrr::map(points_list,
~weights_loo(.x, cdf = cdf))
weights_fun_prod <- purrr::map2(weights_list, points_list,
~.x$weights^2 * phi(.y))
#second_mom <- purrr::map(weights_list, ~.x$weights^2)
Reduce('+', weights_fun_prod) / length(weights_fun_prod)
}
a <- 1
n <- 100
m <- 25
points_list <- purrr::map(seq_len(n), function(x) boat_cdf(a = 1, n = 25))
wm_sq_limit
args(wm_sq_limit)
cdf <-
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24)
cdf <-
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24)
weights_list <- purrr::map(points_list,
~weights_loo(.x, cdf = cdf))
cdf = function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
weights_list <- purrr::map(points_list,
~weights_loo(.x, cdf = cdf))
weights_list
weights_fun_prod <- purrr::map2(weights_list, points_list,
~.x$weights^2 * phi(.y))
Reduce('+', weights_fun_prod) / length(weights_fun_prod)
wm_sq_limit <- function(points_list, phi = function(x) 1, cdf = identity) {
#points_list <- purrr::map(seq_len(n), ~runif(m))
weights_list <- purrr::map(points_list,
~weights_loo(.x, cdf = cdf))
weights_fun_prod <- purrr::map2(weights_list, points_list,
~.x$weights^2 * phi(.y))
#second_mom <- purrr::map(weights_list, ~.x$weights^2)
Reduce('+', weights_fun_prod) / length(weights_fun_prod)
}
cdf <-
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24)
Reduce('+', weights_fun_prod) / length(weights_fun_prod)
args(wm_sq_limit)
wm_sq_limit <- function(points_list, phi = function(x) 1, cdf = identity) {
#points_list <- purrr::map(seq_len(n), ~runif(m))
weights_list <- purrr::map(points_list,
~weights_loo(.x, cdf = cdf))
weights_fun_prod <- purrr::map2(weights_list, points_list,
~.x$weights^2 * phi(.y))
#second_mom <- purrr::map(weights_list, ~.x$weights^2)
Reduce('+', weights_fun_prod) / length(weights_fun_prod)
}
wm_Sq_limit
wm_sq_limit
wm_sq_limit <- function(points_list, phi = function(x) 1, cdf = identity) {
#points_list <- purrr::map(seq_len(n), ~runif(m))
weights_list <- purrr::map(points_list,
~weights_loo(.x, cdf = cdf))
weights_fun_prod <- purrr::map2(weights_list, points_list,
~.x$weights^2 * phi(.y))
#second_mom <- purrr::map(weights_list, ~.x$weights^2)
Reduce('+', weights_fun_prod) / length(weights_fun_prod)
}
a <- 1
n <- 100
m <- 25
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |> mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 1000))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 25))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 100))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 1000))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |>
mean()
wm_sq_limit(points_list = points_list,
phi = function(x) identity,
cdf = cdf) |>
mean()
wm_sq_limit(points_list = points_list,
phi = identity,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 100))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
wm_sq_limit(points_list = points_list,
phi = identity,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 500))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
wm_sq_limit(points_list = points_list,
phi = identity,
cdf = cdf) |>
mean()
# wm_sq_limit(n = 1000,
#             m = 500,
#             phi = identity)
#
#
wm_sq_limit(points_list = points_list,
phi = function(x) (sin(x))^2,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 25))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |>
mean()
points_list <- purrr::map(seq_len(1000), function(x) boat_cdf(a = 1, n = 500))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf) |>
mean()
wm_sq_limit(points_list = points_list,
phi = identity,
cdf = cdf) |>
mean()
wm_sq_limit(points_list = points_list,
phi = function(x) (sin(x))^2,
cdf = cdf) |>
mean()
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)[2]
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
points_list
points_list <- purrr::map(seq_len(1000), function(x) sort(boat_cdf(a = 1, n = 500)))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
boat_cdf(a = 1, n = 500)
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = cdf)
points_list <- purrr::map(seq_len(1000), function(x) sort(runif(500)))
cdf <- function(x) 1/3*(x - 0.5)^3 + 11*x/12 + 1/24
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = function(x) x)
x
x
points_list <- purrr::map(seq_len(1000), function(x) sort(runif(500)))
?degree
map(points_list, ~degree(.x))
purrr::map(points_list, ~degree(.x))
purrr::map(points_list, ~degree(.x)$deg) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
points_list <- purrr::map(seq_len(10000), function(x) sort(runif(50)))
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
?cum_vol
purrr::map(points_list, ~cum_vol(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x))
purrr::map(points_list, ~cum_vol(.x)$vol) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol^2) |>
(\(x) Reduce('+', x) / length(x))()
points_list <- purrr::map(seq_len(10000), function(x) sort(runif(200)))
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
5/8
7/2+1/2-5/4
# some choices of function to play
wm_sq_limit(points_list = points_list,
phi = function(x) 1,
cdf = function(x) x)
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
View(id_real)
purrr::map(points_list, ~cum_vol(.x)$vol^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
73/4
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
3.5+0.5-5/8
3/2+3/2-2*3/4
7/8
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
points_list <- purrr::map(seq_len(10000), function(x) sort(runif(500)))
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
points_list <- purrr::map(seq_len(100000), function(x) sort(runif(200)))
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
points_list <- purrr::map(seq_len(10000), function(x) sort(runif(200)))
purrr::map(points_list, ~cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
5/8
11/8
11/4
purrr::map(points_list, ~cum_vol(.x)$vol^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~degree(.x)$deg^2) |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
5/4
5/2
points_list <- purrr::map(seq_len(100), function(x) sort(runif(20)))
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))() |> mean()
3/2
3/2+3/2-7/4+1
3+1
7/4
3/2+3/2-7/4+1
devtools::document()
document()
rm(boat_cdf, weights_loo)
document()
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
points_list <- purrr::map(seq_len(10000), function(x) sort(runif(200)))
purrr::map(points_list, ~cum_vol(.x)$vol^2 + degree(.x)$deg^2 -
2 * cum_vol(.x)$vol * degree(.x)$deg)   |>
(\(x) Reduce('+', x) / length(x))()
11/4
n
n = 101
x <- seq(0, 1, length.out = n)
k
k = 500
k
n
ek <- sqrt(2) * sin(outer((seq_len(k) - 0.5), pi * x))
ek
dim(ek)
lambda_k <- (k - 0.5)^(-2)*pi^(-2)
lambda_kj
lambda_k
lambda_k <- (seq_len(k) - 0.5)^(-2) * pi^(-2)
lambda_k
test = 1/((seq_len(k) - 0.5)^2 * pi^2)
tewt
test
lambda_k == test
lambda_k
test
round(lambda_k, 7) == round(test, 7)
rm(test)
View(ek)
lambda_k
?rnorm
xi_k <- rnorm(n = k, mean = 0, sd = 1)
xi_k
?sweep
